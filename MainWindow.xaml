<Window x:Class="MermaidEditor.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="WinUI3 Mermaid Diagram Editor">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <MenuBar Grid.Row="0" Background="{ThemeResource SystemControlBackgroundAltHighBrush}">
            <MenuBarItem Title="File">
                <MenuFlyoutItem Text="New" Click="NewFile_Click">
                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Modifiers="Control" Key="N"/>
                    </MenuFlyoutItem.KeyboardAccelerators>
                </MenuFlyoutItem>
                <MenuFlyoutSeparator/>
                <MenuFlyoutSubItem Text="New UML Template">
                    <MenuFlyoutItem Text="Class Diagram" Click="NewClassDiagram_Click"/>
                    <MenuFlyoutItem Text="Sequence Diagram" Click="NewSequenceDiagram_Click"/>
                    <MenuFlyoutItem Text="State Diagram" Click="NewStateDiagram_Click"/>
                </MenuFlyoutSubItem>
                <MenuFlyoutSeparator/>
                <MenuFlyoutItem Text="Open..." Click="OpenFile_Click">
                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Modifiers="Control" Key="O"/>
                    </MenuFlyoutItem.KeyboardAccelerators>
                </MenuFlyoutItem>
                <MenuFlyoutItem Text="Save" Click="SaveFile_Click">
                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Modifiers="Control" Key="S"/>
                    </MenuFlyoutItem.KeyboardAccelerators>
                </MenuFlyoutItem>
                <MenuFlyoutItem Text="Save As..." Click="SaveAsFile_Click"/>
                <MenuFlyoutSeparator/>
                <MenuFlyoutItem Text="Exit" Click="Exit_Click"/>
            </MenuBarItem>
            <MenuBarItem Title="Edit">
                <MenuFlyoutItem Text="Undo" Click="Undo_Click">
                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Modifiers="Control" Key="Z"/>
                    </MenuFlyoutItem.KeyboardAccelerators>
                </MenuFlyoutItem>
                <MenuFlyoutItem Text="Redo" Click="Redo_Click">
                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Modifiers="Control" Key="Y"/>
                    </MenuFlyoutItem.KeyboardAccelerators>
                </MenuFlyoutItem>
            </MenuBarItem>
            <MenuBarItem Title="View">
                <MenuFlyoutItem Text="Refresh Preview" Click="RefreshPreview_Click">
                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Key="F5"/>
                    </MenuFlyoutItem.KeyboardAccelerators>
                </MenuFlyoutItem>
            </MenuBarItem>
        </MenuBar>

        <!-- Main Content Area with Split View -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" MinWidth="300"/>
                <ColumnDefinition Width="5"/>
                <ColumnDefinition Width="*" MinWidth="300"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel - Text Editor -->
            <Border Grid.Column="0" 
                    Background="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}"
                    BorderBrush="{ThemeResource SystemControlForegroundBaseMediumLowBrush}"
                    BorderThickness="1"
                    CornerRadius="4"
                    Margin="8">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Editor Header -->
                    <Border Grid.Row="0" 
                            Background="{ThemeResource SystemControlBackgroundBaseLowBrush}"
                            Padding="12,8">
                        <TextBlock Text="Mermaid Code Editor" 
                                   FontWeight="SemiBold"
                                   Foreground="{ThemeResource SystemControlForegroundBaseHighBrush}"/>
                    </Border>
                    
                    <!-- Text Editor -->
                    <ScrollViewer Grid.Row="1" 
                                  ZoomMode="Disabled"
                                  HorizontalScrollMode="Auto"
                                  HorizontalScrollBarVisibility="Auto"
                                  VerticalScrollBarVisibility="Auto">
                        <TextBox x:Name="CodeEditor"
                                 AcceptsReturn="True"
                                 TextWrapping="NoWrap"
                                 FontFamily="Consolas, Courier New, monospace"
                                 FontSize="14"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 Padding="12"
                                 PlaceholderText="Enter your Mermaid diagram code here..."
                                 TextChanged="CodeEditor_TextChanged"/>
                    </ScrollViewer>
                </Grid>
            </Border>

            <!-- Splitter -->
            <Border Grid.Column="1" 
                    Background="{ThemeResource SystemControlBackgroundBaseMediumBrush}"/>

            <!-- Right Panel - Preview -->
            <Border Grid.Column="2" 
                    Background="{ThemeResource SystemControlBackgroundChromeMediumLowBrush}"
                    BorderBrush="{ThemeResource SystemControlForegroundBaseMediumLowBrush}"
                    BorderThickness="1"
                    CornerRadius="4"
                    Margin="8">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Preview Header -->
                    <Border Grid.Row="0" 
                            Background="{ThemeResource SystemControlBackgroundBaseLowBrush}"
                            Padding="12,8">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock Text="Diagram Preview" 
                                       FontWeight="SemiBold"
                                       Foreground="{ThemeResource SystemControlForegroundBaseHighBrush}"
                                       VerticalAlignment="Center"/>
                            <Button x:Name="RefreshButton"
                                    Content="â†»"
                                    FontSize="16"
                                    Width="32"
                                    Height="32"
                                    Click="RefreshPreview_Click"
                                    ToolTipService.ToolTip="Refresh Preview"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Preview Panel -->
                    <Border Grid.Row="1" 
                            Background="White"
                            Margin="8">
                        <ScrollViewer ZoomMode="Enabled" HorizontalScrollMode="Auto" VerticalScrollMode="Auto">
                            <TextBlock x:Name="DiagramPreview" 
                                      Text="Mermaid diagram preview will be implemented in next sprint"
                                      FontSize="16"
                                      Foreground="Gray"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"
                                      Margin="20"/>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </Border>
        </Grid>

        <!-- Status Bar -->
        <Border Grid.Row="2" 
                Background="{ThemeResource SystemControlBackgroundBaseLowBrush}"
                BorderBrush="{ThemeResource SystemControlForegroundBaseMediumLowBrush}"
                BorderThickness="0,1,0,0"
                Padding="12,4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock x:Name="StatusText" 
                           Grid.Column="0"
                           Text="Ready"
                           VerticalAlignment="Center"
                           Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                
                <StackPanel Grid.Column="1" 
                            Orientation="Horizontal" 
                            Spacing="16">
                    <TextBlock x:Name="LineColumnText"
                               Text="Ln 1, Col 1"
                               VerticalAlignment="Center"
                               Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                    <TextBlock x:Name="CharCountText"
                               Text="0 characters"
                               VerticalAlignment="Center"
                               Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
