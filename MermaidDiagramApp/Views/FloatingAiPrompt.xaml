<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="MermaidDiagramApp.Views.FloatingAiPrompt"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Border x:Name="RootBorder"
            Background="{ThemeResource LayerFillColorDefaultBrush}"
            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
            BorderThickness="1"
            CornerRadius="8"
            Padding="12"
            MinWidth="520"
            PointerPressed="RootBorder_PointerPressed"
            PointerReleased="RootBorder_PointerReleased"
            PointerMoved="RootBorder_PointerMoved">
        <StackPanel Spacing="10">
            <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                <TextBlock Text="AI" Style="{ThemeResource SubtitleTextBlockStyle}"/>
                <StackPanel Orientation="Horizontal" Spacing="6" HorizontalAlignment="Stretch">
                    <ComboBox Width="110" ItemsSource="{Binding Providers}" SelectedItem="{Binding SelectedProvider, Mode=TwoWay}"/>
                    <ComboBox Width="120" ItemsSource="{Binding Models}" SelectedItem="{Binding SelectedModel, Mode=TwoWay}"/>
                    <Button Content="Configure…" Click="ConfigureButton_Click"/>
                    <Button x:Name="PopOutButton" Content="Pop out" Click="PopOutButton_Click"/>
                </StackPanel>
            </StackPanel>

            <StackPanel>
                <Slider Minimum="0.0" Maximum="1.0" StepFrequency="0.1" Value="{Binding Temperature, Mode=TwoWay}">
                    <Slider.Header>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock Text="Temperature"/>
                            <TextBlock Text="{Binding Temperature, Converter={StaticResource DoubleToStringFormatConverter}, ConverterParameter=F1}"/>
                        </StackPanel>
                    </Slider.Header>
                </Slider>
            </StackPanel>

            <TextBox x:Name="PromptBox" Text="{Binding UserPrompt, Mode=TwoWay}" AcceptsReturn="True" TextWrapping="Wrap" Height="120" PlaceholderText="Describe your diagram…"/>

            <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                <Button Content="Generate" Click="GenerateButton_Click" IsEnabled="{Binding IsGenerating, Converter={StaticResource InverseBooleanConverter}}"/>
                <Button Content="Suggest Type" Click="SuggestTypeButton_Click" IsEnabled="{Binding IsGenerating, Converter={StaticResource InverseBooleanConverter}}"/>
                <ProgressRing IsActive="{Binding IsGenerating}" Width="20" Height="20"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right">
                <Button Content="Insert into Editor" Click="InsertButton_Click" Style="{ThemeResource AccentButtonStyle}"/>
                <Button Content="Import to Canvas" Click="ImportToCanvasButton_Click"/>
                <Button Content="Copy" Click="CopyButton_Click"/>
            </StackPanel>
        </StackPanel>
    </Border>
</UserControl>
